<!DOCTYPE html>

<!-- Import Polymer -->
<link rel="import" href="../bower_components/polymer/polymer.html">

<script type="text/javascript" src="qrcode.min.js"></script>

<!-- Define your custom element -->
<polymer-element name="ripple-pos" attributes="receiver currency size">

<template>
	<div>
		<input type="number"
		value="{{amount}}"
		autofocus
		id="amount"
		width="150px"
		style="height:30px;width:{{size}};padding:0px"
		/>
		<div id="qr"></div>
	</div>
</template>

</polymer-element>

<script>

	Polymer('ripple-pos', {

		amountChanged : function(){

			if(this.$.amount.value >= 0){
				amount = this.$.amount.value;
			}
			else{
				amount = 0;
			}

			var uri = 'http://ripple.com//send?to=' + encodeURIComponent(this.receiver) + '&amount=' + encodeURIComponent(amount) + 
			'/' + encodeURIComponent(this.currency);

			console.log(uri);
			qrcode.makeCode(uri);
		},

		created: function(){

			receiver = '',
			currency = 'XRP',
			height = 100,
			width = 100
		},

		ready: function() {

			receiver = this.receiver,
			currency = this.currency,
			qrcode = new QRCode(this.$.qr, {
				text: 'http://ripple.com//send?to=' + encodeURIComponent(this.receiver) + '&amount=' + 0 + 
				'/' + encodeURIComponent(this.currency),
				width: this.size,
				height:this.size-30,
				correctLevel : QRCode.CorrectLevel.H
			});
		}});
	
</script>